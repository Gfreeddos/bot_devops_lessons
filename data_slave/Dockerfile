FROM postgres:14

ARG DB_REPL_USER
ARG DB_REPL_PASSWORD
ARG DB_REPL_HOST
ARG DB_REPL_PORT
ARG DB_HOST
ARG DB_PORT

ENV POSTGRES_USER=$DB_REPL_USER
ENV POSTGRES_PASSWORD=$DB_REPL_PASSWORD
ENV PG_HOST=$DB_REPL_HOST
ENV DB_REPL_PORT=$DB_REPL_PORT
ENV DB_HOST=$DB_HOST
ENV DB_PORT=$DB_PORT
ENV PGPASSWORD=$DB_REPL_PASSWORD

ENV PGDATA="/var/lib/postgresql/data/pgdata"

COPY ./entrypoint.sh /

RUN ["chmod", "+x", "/entrypoint.sh"]

ENTRYPOINT ["/entrypoint.sh"]
